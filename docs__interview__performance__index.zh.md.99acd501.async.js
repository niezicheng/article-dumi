(self["webpackChunkdocs_dumi"]=self["webpackChunkdocs_dumi"]||[]).push([[4083],{50910:function(e,t,n){"use strict";n.r(t);var l=n(67294),c=n(96089),r=n(65659);n(45139);t["default"]=e=>(l.useEffect((()=>{var t;null!==e&&void 0!==e&&null!==(t=e.location)&&void 0!==t&&t.hash&&c.AnchorLink.scrollToAnchor(decodeURIComponent(e.location.hash.slice(1)))}),[]),l.createElement(l.Fragment,null,l.createElement("div",{className:"markdown"},l.createElement("h2",{id:"web-\u5404\u4e2a\u9636\u6bb5\u7684\u6027\u80fd\u4f18\u5316"},l.createElement(c.AnchorLink,{to:"#web-\u5404\u4e2a\u9636\u6bb5\u7684\u6027\u80fd\u4f18\u5316","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"web \u5404\u4e2a\u9636\u6bb5\u7684\u6027\u80fd\u4f18\u5316"),l.createElement("p",null,l.createElement(c.Link,{to:"https://mp.weixin.qq.com/s/XSvhOF_N0VbuOKStwi0IYw"},"React 16 \u52a0\u8f7d\u6027\u80fd\u4f18\u5316\u6307\u5357")),l.createElement("h2",{id:"\u7f51\u9875\u57fa\u672c\u6027\u80fd\u4f18\u5316"},l.createElement(c.AnchorLink,{to:"#\u7f51\u9875\u57fa\u672c\u6027\u80fd\u4f18\u5316","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u7f51\u9875\u57fa\u672c\u6027\u80fd\u4f18\u5316"),l.createElement("ul",null,l.createElement("li",null,"\u51cf\u5c11 ",l.createElement("code",null,"HTTP")," \u8bf7\u6c42"),l.createElement("li",null,"\u4f7f\u7528\u5185\u5bb9\u53d1\u5e03\u7f51\u7edc(CDN)"),l.createElement("li",null,"\u6dfb\u52a0\u672c\u5730\u7f13\u5b58"),l.createElement("li",null,"\u538b\u7f29\u8d44\u6e90\u6587\u4ef6"),l.createElement("li",null,"\u5c06 ",l.createElement("code",null,"CSS")," \u6837\u5f0f\u8868\u653e\u5728\u9876\u90e8\uff0c\u628a ",l.createElement("code",null,"javascript")," \u653e\u5728\u5e95\u90e8(\u6d4f\u89c8\u5668\u7684\u8fd0\u884c\u673a\u5236\u51b3\u5b9a) \u907f\u514d\u4f7f\u7528 ",l.createElement("code",null,"CSS")," \u8868\u8fbe\u5f0f"),l.createElement("li",null,"\u51cf\u5c11 ",l.createElement("code",null,"DNS")," \u67e5\u8be2"),l.createElement("li",null,"\u4f7f\u7528\u5916\u90e8 ",l.createElement("code",null,"javascript")," \u548c ",l.createElement("code",null,"CSS")),l.createElement("li",null,"\u907f\u514d\u91cd\u5b9a\u5411"),l.createElement("li",null,"\u56fe\u7247\u61d2\u52a0\u8f7d ",l.createElement("code",null,"lazyLoad")," ",l.createElement(c.Link,{to:"https://q.shanyue.tech/fe/html/1.html"},"\u94fe\u63a5"))),l.createElement("p",null,l.createElement(c.Link,{to:"https://juejin.cn/post/6911472693405548557"},"\u804a\u4e00\u804a\u524d\u7aef\u6027\u80fd\u4f18\u5316")),l.createElement("p",null,l.createElement(c.Link,{to:"https://juejin.cn/post/6981673766178783262"},"\u5199\u7ed9\u4e2d\u9ad8\u7ea7\u524d\u7aef\u5173\u4e8e\u6027\u80fd\u4f18\u5316\u7684 9 \u5927\u7b56\u7565\u548c 6 \u5927\u6307\u6807 | \u7f51\u6613\u56db\u5e74\u5b9e\u8df5")),l.createElement("h2",{id:"\u56fe\u7247\u7684\u9884\u52a0\u8f7d\u548c\u61d2\u52a0\u8f7d"},l.createElement(c.AnchorLink,{to:"#\u56fe\u7247\u7684\u9884\u52a0\u8f7d\u548c\u61d2\u52a0\u8f7d","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u56fe\u7247\u7684\u9884\u52a0\u8f7d\u548c\u61d2\u52a0\u8f7d"),l.createElement("p",null,l.createElement("strong",null,"\u9884\u52a0\u8f7d:")),l.createElement("ul",null,l.createElement("li",null,"\u63d0\u524d\u52a0\u8f7d\u56fe\u7247\uff0c\u5f53\u7528\u6237\u9700\u8981\u67e5\u770b\u65f6\u53ef\u76f4\u63a5\u4ece\u672c\u5730\u7f13\u5b58\u4e2d\u6e32\u67d3")),l.createElement("p",null,l.createElement("strong",null,"\u61d2\u52a0\u8f7d:")),l.createElement("ul",null,l.createElement("li",null,"\u61d2\u52a0\u8f7d\u7684\u4e3b\u8981\u76ee\u7684\u662f\u4f5c\u4e3a\u670d\u52a1\u5668\u524d\u7aef\u7684\u4f18\u5316\uff0c\u51cf\u5c11\u8bf7\u6c42\u6570\u6216\u5ef6\u8fdf\u8bf7\u6c42\u6570")),l.createElement("p",null,l.createElement("strong",null,"\u4e24\u79cd\u6280\u672f\u7684\u672c\u8d28:")),l.createElement("ul",null,l.createElement("li",null,"\u4e24\u8005\u7684\u884c\u4e3a\u662f\u76f8\u53cd\u7684\uff0c\u4e00\u4e2a\u662f\u63d0\u524d\u52a0\u8f7d\uff0c\u4e00\u4e2a\u662f\u8fdf\u7f13\u751a\u81f3\u4e0d\u52a0\u8f7d"),l.createElement("li",null,"\u61d2\u52a0\u8f7d\u5bf9\u670d\u52a1\u5668\u524d\u7aef\u6709\u4e00\u5b9a\u7684\u7f13\u89e3\u538b\u529b\u4f5c\u7528\uff0c\u9884\u52a0\u8f7d\u5219\u4f1a\u589e\u52a0\u670d\u52a1\u5668\u524d\u7aef\u538b\u529b")),l.createElement("p",null,l.createElement("strong",null,"\u61d2\u52a0\u8f7d\u4f18\u5316\uff1a"),"\u76d1\u542c\u5217\u8868\u5411\u4e0a\u6eda\u52a8\u4e8b\u4ef6\uff0c\u53ea\u5bf9",l.createElement("strong",null,"\u4e0a\u4e00\u6b21\u6700\u540e\u8fdb\u5165\u53ef\u89c6\u7a97\u53e3\u52a0\u8f7d\u7684\u56fe\u7247"),"\u540e\u7684\u6240\u6709\u56fe\u7247\u8fdb\u884c\u5faa\u73af\u76d1\u542c\u5224\u65ad\u662f\u5426\u52a0\u8f7d\u3010\u53bb\u9664\u5bf9\u5df2\u52a0\u8f7d\u7684\u56fe\u7247\u518d\u5faa\u73af\u5904\u7406\u3011"),l.createElement("p",null,l.createElement(c.Link,{to:"https://juejin.cn/post/6844903614138286094"},"\u61d2\u52a0\u8f7d\u548c\u9884\u52a0\u8f7d")),l.createElement("h3",{id:"\u5b9e\u73b0\u56fe\u7247\u61d2\u52a0\u8f7d"},l.createElement(c.AnchorLink,{to:"#\u5b9e\u73b0\u56fe\u7247\u61d2\u52a0\u8f7d","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u5b9e\u73b0\u56fe\u7247\u61d2\u52a0\u8f7d"),l.createElement("ol",null,l.createElement("li",null,"clientHeight\u3001scrollTop \u548c offsetTop")),l.createElement("ul",null,l.createElement("li",null,"clientHeight = CSS height + CSS padding - \u6c34\u5e73\u6eda\u52a8\u6761\u9ad8\u5ea6 (\u5982\u679c\u5b58\u5728)"),l.createElement("li",null,"scrollTop = \u6eda\u52a8\u5143\u7d20\u9876\u90e8\u8ddd\u79bb\u5bb9\u5668\u9876\u90e8\u7684\u9ad8\u5ea6\u3010\u65e0\u6cd5\u6eda\u52a8\u5143\u7d20 scrollTop \u4e3a 0\u3011"),l.createElement("li",null,"offsetTop = \u5143\u7d20\u9876\u90e8\u8ddd\u79bb\u5bb9\u5668\u9876\u90e8\u7684\u9ad8\u5ea6")),l.createElement("p",null,"\u7ed9\u56fe\u7247\u4e00\u4e2a\u5360\u4f4d\u8d44\u6e90:"),l.createElement(r.Z,{code:'<img src="default.jpg" data-src="http://www.xxx.com/target.jpg" />',lang:"html"}),l.createElement("p",null,"\u76d1\u542c ",l.createElement("code",null,"scroll")," \u4e8b\u4ef6\u6765\u5224\u65ad\u56fe\u7247\u662f\u5426\u5230\u8fbe\u89c6\u53e3:"),l.createElement(r.Z,{code:"let img = document.getElementsByTagName('img');\nlet num = img.length;\nlet count = 0; //\u8ba1\u6570\u5668\uff0c\u4ece\u7b2c\u4e00\u5f20\u56fe\u7247\u5f00\u59cb\u8ba1\n\nlazyload(); //\u9996\u6b21\u52a0\u8f7d\u522b\u5fd8\u4e86\u663e\u793a\u56fe\u7247\n\nwindow.addEventListener('scroll', lazyload);\n\nfunction lazyload() {\n  let viewHeight = document.documentElement.clientHeight; //\u89c6\u53e3\u9ad8\u5ea6\n  let scrollTop = document.documentElement.scrollTop || document.body.scrollTop; //\u6eda\u52a8\u6761\u5377\u53bb\u7684\u9ad8\u5ea6\n  for (let i = count; i < num; i++) {\n    // \u5143\u7d20\u73b0\u5728\u5df2\u7ecf\u51fa\u73b0\u5728\u89c6\u53e3\u4e2d\u3010\u56fe\u7247\u8ddd\u79bb\u6eda\u52a8\u7236\u5143\u7d20\u9876\u90e8\u8ddd\u79bb < \u6eda\u52a8\u8d85\u51fa\u7a97\u53e3\u9ad8\u5ea6 + \u7a97\u53e3\u9ad8\u5ea6\u3011\n    if (img[i].offsetTop < scrollHeight + viewHeight) {\n      if (img[i].getAttribute('src') !== 'default.jpg') continue;\n      img[i].src = img[i].getAttribute('data-src');\n      count++;\n    }\n  }\n}",lang:"js"}),l.createElement("p",null,"\u5bf9 scroll \u4e8b\u4ef6\u505a\u8282\u6d41\u5904\u7406\uff0c\u4ee5\u514d\u9891\u7e41\u89e6\u53d1:"),l.createElement(r.Z,{code:"// throttle\u51fd\u6570\u6211\u4eec\u4e0a\u8282\u5df2\u7ecf\u5b9e\u73b0\nwindow.addEventListener('scroll', throttle(lazyload, 200));",lang:"js"}),l.createElement("ol",{start:2},l.createElement("li",null,"getBoundingClientRect")),l.createElement("p",null,l.createElement("code",null,"DOM")," \u5143\u7d20\u7684 ",l.createElement(c.Link,{to:"https://developer.mozilla.org/zh-CN/docs/Web/API/Element/getBoundingClientRect"},"getBoundingClientRect")," API; \u83b7\u53d6\u5143\u7d20\u76f8\u5bf9\u4e8e",l.createElement("strong",null,"\u89c6\u53e3"),"\u7684\u4f4d\u7f6e"),l.createElement(r.Z,{code:"function lazyload() {\n  for (let i = count; i < num; i++) {\n    // \u5143\u7d20\u73b0\u5728\u5df2\u7ecf\u51fa\u73b0\u5728\u89c6\u53e3\u4e2d\n    if (\n      img[i].getBoundingClientRect().top < document.documentElement.clientHeight\n    ) {\n      if (img[i].getAttribute('src') !== 'default.jpg') continue;\n      img[i].src = img[i].getAttribute('data-src');\n      count++;\n    }\n  }\n}",lang:"js"}),l.createElement("ol",{start:3},l.createElement("li",null,"IntersectionObserver")),l.createElement("p",null,"\u6d4f\u89c8\u5668\u5185\u7f6e\u7684 API ",l.createElement(c.Link,{to:"https://developer.mozilla.org/zh-CN/docs/Web/API/IntersectionObserver"},"IntersectionObserver"),"\uff0c\u5b9e\u73b0\u4e86\u76d1\u542c ",l.createElement("code",null,"window")," \u7684 ",l.createElement("code",null,"scroll")," \u4e8b\u4ef6\u3001\u5224\u65ad\u662f\u5426\u5728\u89c6\u53e3\u4e2d\u4ee5\u53ca\u8282\u6d41\u4e09\u5927\u529f\u80fd\uff1b",l.createElement("code",null,"IntersectionObserver")," \u4e5f\u53ef\u4ee5\u7528\u4f5c\u5176\u4ed6\u8d44\u6e90\u7684\u9884\u52a0\u8f7d"),l.createElement(r.Z,{code:"let img = document.getElementsByTagName('img');\n\nconst observer = new IntersectionObserver(changes => {\n  //changes \u662f\u88ab\u89c2\u5bdf\u7684\u5143\u7d20\u96c6\u5408\n  for (let i = 0, len = changes.length; i < len; i++) {\n    let change = changes[i];\n    // \u901a\u8fc7\u8fd9\u4e2a\u5c5e\u6027\u5224\u65ad\u662f\u5426\u5728\u89c6\u53e3\u4e2d\n    if (change.isIntersecting) {\n      const imgElement = change.target;\n      imgElement.src = imgElement.getAttribute('data-src');\n      observer.unobserve(imgElement);\n    }\n  }\n});\n\nArray.from(img).forEach(item => observer.observe(item));",lang:"js"}))))}}]);